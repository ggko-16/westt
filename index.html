<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WestFace</title>
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
<link rel="stylesheet" href="./style.css">
</head>
<body>

<header>
    <nav>
        <div class="logo"><a href="index.html">WestFace</a></div>
        <div class="burger-menu" id="burgerMenu"><span></span><span></span><span></span></div>
        <ul class="nav-links" id="navLinks">
            <li><a href="#home">მთავარი</a></li>
            <li><a href="#services">სერვისები</a></li>
            <li><a href="#prices">ფასები</a></li>
            <li><a href="#gallery">გალერეა</a></li>
            <li><a href="#team">გუნდი</a></li>
            <li><a href="#order">შეკვეთა</a></li>
            <li><a href="#contact">კონტაქტი</a></li>
        </ul>
    </nav>
</header>

<section id="home" class="hero">
    <h1>პროფესიონალური ფოტოების ბეჭდვა</h1>
    <p>ვამზადებთ მაღალი ხარისხის პოსტერებს და ვბეჭდავთ ფოტოებს ნებისმიერ ზომაზე</p>
    <a href="#order" class="cta-button">ონლაინ შეკვეთა</a>
</section>

<section id="services">
    <h2>ჩვენი სერვისები</h2>
    <div class="services-grid">
        <div class="service-card">
            <div class="service-icon">🖼️</div>
            <h3>პოსტერების დამზადება</h3>
            <p>მაღალი ხარისხის პოსტერები ნებისმიერი ზომით და დიზაინით. თქვენი იდეები ცხოვრებას ვაჩენთ.</p>
        </div>
        <div class="service-card">
            <div class="service-icon">📷</div>
            <h3>ფოტოების ბეჭდვა</h3>
            <p>ვბეჭდავთ ფოტოებს სხვადასხვა ზომაზე - პატარა ფორმატიდან დიდ ზომამდე.</p>
        </div>
        <div class="service-card">
            <div class="service-icon">🎨</div>
            <h3>დიზაინის მომსახურება</h3>
            <p>პროფესიონალური დიზაინის შექმნა თქვენი საჭიროებების მიხედვით.</p>
        </div>
    </div>
</section>

<section id="prices" style="background:#f8f9fa;">
    <h2>ფასები</h2>
    <div id="price-tables" class="price-tables"></div>
</section>

<section id="gallery">
    <h2>ჩვენი სამუშაოები</h2>
    <div id="gallery-grid" class="gallery-grid"></div>
</section>

<section id="team">
    <h2>ჩვენი გუნდი</h2>
    <div id="team-grid" class="team-grid"></div>
</section>

<section id="order">
    <h2>შეკვეთა</h2>
    <div class="delivery-info">
        <h3>🚚 მიწოდება</h3>
        <div class="delivery-card">
            <p><strong>თბილისში:</strong> უფასო მიწოდება</p>
            <p><strong>რეგიონებში:</strong> +10-15₾</p>
        </div>
    </div>
</section>

<section id="order-form" style="background:#f8f9fa;">
    <h2>ონლაინ შეკვეთა</h2>
    <div style="max-width:800px;margin:0 auto;background:white;padding:2rem;border-radius:15px;box-shadow:0 5px 15px rgba(0,0,0,0.1);display:flex;align-items:center;flex-direction:column;gap:15px;">
        <h4>შესაკვეთად, ფოტოს გამოგზავნისთვის დააჭირეთ გამოგზავნის ღილაკს</h4>
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSf6JAXeVfGSjVxEPvaqJHKkbMlgD2f5MffAT7EAY7zp0vQoeg/viewform?usp=dialog" target="_blank" rel="noopener noreferrer" class="form-btn">გამოგზავნეთ</a>
    </div>
</section>

<section id="contact">
    <h2>დაგვიკავშირდით</h2>
    <div class="contact-info">
        <div class="contact-item">
            <h3>📞 ტელეფონი</h3>
            <p id="contact-phone">+995 574 80 7066</p>
        </div>
        <div class="contact-item">
            <h3>✉️ ელ-ფოსტა</h3>
            <p id="contact-email">westfaceshop@gmail.com</p>
        </div>
        <div class="contact-item">
            <h3>📍 მისამართი</h3>
            <p id="contact-address">თბილისი</p>
        </div>
    </div>
    <div style="text-align: center; margin-top: 3rem;">
        <a href="https://www.facebook.com/share/1AG2cTct6t/?mibextid=wwXIfr" target="_blank" style="display: inline-block; background: #1877f2; color: white; padding: 1rem 2rem; border-radius: 10px; text-decoration: none; font-size: 1.1rem; transition: transform 0.3s;">
            📘 Facebook - westface shop
        </a>
    </div>
</section>

<footer>
    <p>&copy; 2026 WestFace Shop. ყველა უფლება დაცულია.</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
// Burger Menu
const burgerMenu = document.getElementById('burgerMenu');
const navLinks = document.getElementById('navLinks');

burgerMenu.addEventListener('click', () => {
    navLinks.classList.toggle('active');
    burgerMenu.classList.toggle('active');
});

navLinks.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
        navLinks.classList.remove('active');
        burgerMenu.classList.remove('active');
    });
});

document.addEventListener('click', (e) => {
    if (!navLinks.contains(e.target) && !burgerMenu.contains(e.target)) {
        navLinks.classList.remove('active');
        burgerMenu.classList.remove('active');
    }
});

// Smooth scroll
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            const headerOffset = 80;
            const elementPosition = target.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
            window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
        }
    });
});

// Scroll animations
const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('visible');
    });
}, observerOptions);

function initScrollAnimations() {
    document.querySelectorAll('.service-card').forEach((card, i) => {
        card.classList.add(`delay-${(i % 3) + 1}`);
        observer.observe(card);
    });
    document.querySelectorAll('.price-table').forEach((table, i) => {
        table.classList.add(`delay-${(i % 3) + 1}`);
        observer.observe(table);
    });
    document.querySelectorAll('.gallery-item').forEach((item, i) => {
        item.classList.add(`delay-${(i % 6) + 1}`);
        observer.observe(item);
    });
    document.querySelectorAll('.team-member').forEach((member, i) => {
        member.classList.add(`delay-${(i % 3) + 1}`);
        observer.observe(member);
    });
    document.querySelectorAll('.contact-item').forEach((item, i) => {
        item.classList.add('fade-in', `delay-${i + 1}`);
        observer.observe(item);
    });
}

// Load JSON helper
async function loadJSON(path) {
    try {
        const res = await fetch(path);
        if (!res.ok) return null;
        return await res.json();
    } catch (e) {
        return null;
    }
}

// Load contact
async function loadContact() {
    const data = await loadJSON('/content/contact.json');
    if (data) {
        document.getElementById('contact-phone').innerHTML = `<a href="tel:${data.phone.replace(/\s/g, '')}" style="color: #333; text-decoration: none;">${data.phone}</a>`;
        document.getElementById('contact-email').innerHTML = `<a href="mailto:${data.email}" style="color: #333; text-decoration: none;">${data.email}</a>`;
        document.getElementById('contact-address').innerText = data.address;
    }
}

// Load team
async function loadTeam() {
    const data = await loadJSON('/content/team.json');
    const grid = document.getElementById('team-grid');
    if (data && data.members) {
        grid.innerHTML = '';
        data.members.forEach(m => {
            const div = document.createElement('div');
            div.classList.add('team-member');
            div.innerHTML = `<div class="team-photo">${m.photo ? `<img src="${m.photo}" alt="${m.name}" style="width:100%;height:100%;object-fit:cover;border-radius:50%">` : '👤'}</div><h3>${m.name}</h3><p>${m.position}</p>`;
            grid.appendChild(div);
        });
    }
}

// Load gallery - works with ANY filename from Netlify CMS
async function loadGallery() {
    const grid = document.getElementById('gallery-grid');
    grid.innerHTML = '';
    
    try {
        // Use GitHub API to list all files in content/gallery folder
        const response = await axios.get('https://api.github.com/repos/ggko-16/westface/contents/content/gallery');
        
        if (response.data && Array.isArray(response.data)) {
            const galleryItems = [];
            
            // Load each JSON file
            for (const file of response.data) {
                if (file.name.endsWith('.json')) {
                    const data = await loadJSON(`/content/gallery/${file.name}`);
                    if (data && data.image) {
                        galleryItems.push(data);
                    }
                }
            }
            
            // Sort by order field
            galleryItems.sort((a, b) => (a.order || 999) - (b.order || 999));
            
            // Display images
            if (galleryItems.length > 0) {
                galleryItems.forEach(item => {
                    const div = document.createElement('div');
                    div.classList.add('gallery-item');
                    div.innerHTML = `<img src="${item.image}" alt="${item.title || 'Gallery'}" style="width:100%;height:100%;object-fit:cover;">`;
                    grid.appendChild(div);
                });
            } else {
                showPlaceholders();
            }
        } else {
            showPlaceholders();
        }
    } catch (error) {
        console.log('Gallery error:', error);
        showPlaceholders();
    }
    
    function showPlaceholders() {
        for (let i = 1; i <= 6; i++) {
            const div = document.createElement('div');
            div.classList.add('gallery-item');
            div.textContent = `პოსტერი ${i}`;
            grid.appendChild(div);
        }
    }
}

// Load prices
async function loadPrices() {
    const container = document.getElementById('price-tables');
    const files = [
        { path: '/content/prices/photo.json', title: '📸 ფოტო სერვისები' },
        { path: '/content/prices/printing.json', title: '🖨️ სკანირება და ბეჭდვა' },
        { path: '/content/prices/frames.json', title: '🖼️ ჩარჩოები' }
    ];
    
    for (const file of files) {
        const data = await loadJSON(file.path);
        if (data && data.services) {
            const div = document.createElement('div');
            div.classList.add('price-table');
            const rows = data.services.map(s => `<tr><td>${s.name}</td><td class="price">${s.price}</td></tr>`).join('');
            div.innerHTML = `<h3>${file.title}</h3><table>${rows}</table>`;
            container.appendChild(div);
        }
    }
}

// Load all content
document.addEventListener('DOMContentLoaded', async () => {
    await loadContact();
    await loadTeam();
    await loadGallery();
    await loadPrices();
    setTimeout(initScrollAnimations, 100);
});
</script>

<script>
if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", user => {
        if (!user) {
            window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; });
        }
    });
}
</script>

</body>
</html>
